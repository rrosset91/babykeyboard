@isTest
public class NBA_IntegrationUtils_Test {

	//@isTest
	//public static void getMock(){
	
		//String retorno = NBA_IntegrationUtils.getMock();
		//System.assert(!String.isBlank(retorno));

		//NBA_IntegrationModels.SearchOffersResponse response = NBA_IntegrationUtils.searchMock();
		//System.assertNotEquals(response, null);

		//String nomeConfiguracao = 'NBA_List_Offers';
		//NBA_Integration_Definitions__mdt configuracao = NBA_IntegrationUtils.getConfiguracaoDeIntegracao(nomeConfiguracao);
		//System.assertEquals('NBA_List_Offers', configuracao.DeveloperName);
	//}


	@IsTest
	public static void sendRequest(){

		String SET_HEADER_KEY = 'Content-Type';
		String SET_HEADER_VALUE = 'application/json';
		Integer STATUS_CODE_SUCCS = 200;
		String MOCK = '{"apiVersion":"1;2019-01-23","transactionId":"Id-56dd7f5cc90171d038e88ee0","data":{"current":{"cost":{"broadband":{},"mobile":{},"phone":{},"total":"0.0","tv":{"aLaCarte":"0.0"}},"products":[{"baseId":"BHZ","category":"TV PACOTE","id":"9529","name":"ESSENCIAL HD CINEMA FUTEBOL","price":"169.9","fidelity":{"startDate":"2019-02-20 00:00:00.0","hasFidelity":"2","penalty":"29.90"},"promotion":{"startDate":"2007-07-31 00:00:00.0"}},{"baseId":"BHZ","category":"TV A LA CARTE","id":"139","name":"Futebol HD ","price":"109.9","fidelity":{"startDate":"2019-02-20 00:00:00.0","hasFidelity":"2","penalty":"29.90"},"promotion":{"startDate":"2007-07-31 00:00:00.0","validFor":null}},{"baseId":"BHZ","category":"BL ASSINATURA","id":"12792","name":"30 MB","price":"79.9","fidelity":{"startDate":"2019-02-20 00:00:00.0","hasFidelity":"2","penalty":"29.90"},"promotion":{"startDate":"2011-02-20 00:00:00.0","validFor":"2","discount":"29.90"}},{"baseId":"BHZ","category":"NET FONE","id":"12792","name":"ILIMITADO BRASIL","price":"20","promotion":{"startDate":"2011-02-20 00:00:00.0"}},{"baseId":"BHZ","category":"MOVEL ASSINATURA","id":"12792","name":"Controle + 5GB","price":"99","promotion":{"startDate":"2011-02-20 00:00:00.0"}},{"baseId":"BHZ","category":"MOVEL DEPENDENTES","id":"12792","name":"2","price":"39.90","promotion":{"startDate":"2011-02-20 00:00:00.0"}}]},"recommendations":[{"id":"1","profile":"Single","priority":"1","actionTv":"Upgrade","actionPhone":"Downgrade","actionBroadband":"Lateral","actionMobile":"Cancelamento","nboBroadband":{"id":null,"baseId":null,"name":"30 MB","price":"49.9","offerType":"Blindagem","promotion":{"id":null,"name":"Promoção","description":"Desconto","discount":{"value":"49.9"}},"validFor":"6","experimentalFor":"2","membershipFee":{"price":null,"paymentMethod":null},"upgradeFee":{"price":null,"paymentMethod":null},"hasFidelity":"True","earlyTerminationFee":{"price":"49.90"},"speed":null},"nboMobile":{"id":null,"baseId":null,"name":"Controle + 5GB","price":"99","offerType":"Combate","promotion":{"id":null,"name":"Promoção","description":"Desconto","discount":{"value":"99"}},"validFor":"6","experimentalFor":"3","membershipFee":{"price":null,"paymentMethod":null},"upgradeFee":{"price":null,"paymentMethod":null},"hasFidelity":"False","earlyTerminationFee":{"price":"99"},"numberOfDependents":null,"speed":null},"nboPhone":{"id":null,"baseId":null,"name":"Ilim. Mundo Total","price":"30","offerType":"Exclusivo","promotion":{"id":null,"name":"Promoção","description":"Desconto","discount":{"value":"30"}},"validFor":"6","experimentalFor":"3","membershipFee":{"price":null,"paymentMethod":null},"upgradeFee":{"price":null,"paymentMethod":null},"hasFidelity":"True","earlyTerminationFee":{"price":"30"},"additionalPoints":null},"nboTv":[{"id":null,"baseId":null,"name":"Essencial HD","price":"139.9","offerType":"string","promotion":{"id":null,"name":"Promoção","description":"Desconto de R$:29.90","discount":{"value":"29.9"}},"validFor":"6","experimentalFor":"2","membershipFee":{"price":"10.00","paymentMethod":null},"upgradeFee":{"price":"20.00","paymentMethod":null},"hasFidelity":"True","earlyTerminationFee":{"price":"20.00"},"additionalPoints":"2","technology":"HD"},{"id":null,"baseId":null,"name":"Essencial HD","price":"139.9","offerType":"string","promotion":{"id":null,"name":"Promoção","description":"Desconto de R$:29.90","discount":{"value":"29.9"}},"validFor":"6","experimentalFor":"2","membershipFee":{"price":"10.00","paymentMethod":null},"upgradeFee":{"price":"20.00","paymentMethod":null},"hasFidelity":"True","earlyTerminationFee":{"price":"20.00"},"additionalPoints":"2","technology":"HD MAX"},{"id":null,"baseId":null,"name":"Essencial HD","price":"139.9","offerType":"string","promotion":{"id":null,"name":"Promoção","description":"Desconto de R$:29.90","discount":{"value":"29.9"}},"validFor":"6","experimentalFor":"2","membershipFee":{"price":"10.00","paymentMethod":null},"upgradeFee":{"price":"20.00","paymentMethod":null},"hasFidelity":"True","earlyTerminationFee":{"price":"20.00"},"additionalPoints":"2","technology":"4K"}],"extras":[{"id":"123","baseId":null,"name":"HBO HD","price":"35","offerType":"Exclusivo","promotion":{"id":null,"name":"Promoção","description":"Desconto","discount":{"value":"20.0","validFor":"6"}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"124","baseId":null,"name":"Telecine HD","price":"40","offerType":"Exclusivo","promotion":{"id":null,"name":"Promoção","description":"Desconto","discount":{"value":"20.0","validFor":"6"}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"125","baseId":null,"name":"Cinema HD (TELECINE + HBO)","price":"70","offerType":"Exclusivo","promotion":{"id":null,"name":"Promoção","description":"Desconto","discount":{"value":"20.0","validFor":"6"}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"126","baseId":null,"name":"Filmes e Séries","price":"90","offerType":"Exclusivo","promotion":{"id":null,"name":"Promoção","description":"Desconto","discount":{"value":"20.0","validFor":"6"}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"127","baseId":null,"name":"Fox Premium HD","price":"24.90","offerType":"Exclusivo","promotion":{"id":null,"name":"Promoção","description":"Desconto","discount":{"value":"20.0","validFor":"6"}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"128","baseId":null,"name":"Séries (Fox Premium + Crackle)","price":"26.90","offerType":"Exclusivo","promotion":{"id":null,"name":"Promoção","description":"Desconto","discount":{"value":"20.0","validFor":"6"}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"129","baseId":null,"name":"Crackle","price":"14.90","offerType":"Exclusivo","promotion":{"id":null,"name":"Promoção","description":"Desconto","discount":{"value":"20.0","validFor":"6"}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"130","baseId":null,"name":"Philos","price":"19.90","offerType":"Exclusivo","promotion":{"id":null,"name":"Promoção","description":"Desconto","discount":{"value":"20.0","validFor":"6"}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"131","baseId":null,"name":"Pacote Adulto","price":"39.90","offerType":"Exclusivo","promotion":{"id":null,"name":"Promoção","description":"Desconto","discount":{"value":"20.0","validFor":"6"}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"132","baseId":null,"name":"Looke","price":"16.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"133","baseId":null,"name":"Sexyhot","price":"32.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"134","baseId":null,"name":"Playboy","price":"32.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"135","baseId":null,"name":"Sextreme","price":"32.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"136","baseId":null,"name":"Vênus","price":"32.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"137","baseId":null,"name":"Forman","price":"22.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"138","baseId":null,"name":"Futebol Digital","price":"109.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"139","baseId":null,"name":"Futebol HD","price":"109.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"140","baseId":null,"name":"Combate HD","price":"79.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"141","baseId":null,"name":"Pacote Esporte","price":"21.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"142","baseId":null,"name":"Pacote Notícia","price":"10.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"143","baseId":null,"name":"Pacote Mundo","price":"10.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"144","baseId":null,"name":"Canal Coreia","price":"41.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"145","baseId":null,"name":"DOGTV ","price":"19.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"TV A LA CARTE","detail":null,"technology":null,"proposedValue":null},{"id":"146","baseId":null,"name":"NET Assist Suport","price":"19.90","offerType":"Exclusivo","promotion":{"id":null,"name":"Promoção","description":"Desconto","discount":{"value":"20.0","validFor":"6"}},"type":"BL ADICIONAIS","detail":null,"technology":null,"proposedValue":null},{"id":"147","baseId":null,"name":"NET Assist Equip","price":"19.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"BL ADICIONAIS","detail":null,"technology":null,"proposedValue":null},{"id":"148","baseId":null,"name":"NET Assist Comb.","price":"19.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"BL ADICIONAIS","detail":null,"technology":null,"proposedValue":null},{"id":"149","baseId":null,"name":"Lar Cyber Rede","price":"50","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"BL ADICIONAIS","detail":null,"technology":null,"proposedValue":null},{"id":"150","baseId":null,"name":"Net cloud - AP","price":"19.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"BL ADICIONAIS","detail":null,"technology":null,"proposedValue":null},{"id":"151","baseId":null,"name":"NET Cloud -P.WEB","price":"39.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"BL ADICIONAIS","detail":null,"technology":null,"proposedValue":null},{"id":"152","baseId":null,"name":"NET Cloud - Domínio Net","price":"54.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"BL ADICIONAIS","detail":null,"technology":null,"proposedValue":null},{"id":"153","baseId":null,"name":"Ponto Ultra","price":"150.00","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"BL ADICIONAIS","detail":null,"technology":null,"proposedValue":null},{"id":"154","baseId":null,"name":"NET BKUP Online","price":"19.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"BL ADICIONAIS","detail":null,"technology":null,"proposedValue":null},{"id":"155","baseId":null,"name":"NET Email","price":"190.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"BL ADICIONAIS","detail":null,"technology":null,"proposedValue":null},{"id":"156","baseId":null,"name":"Claro Música","price":"19.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"MOVEL ADICIONAIS","detail":null,"technology":null,"proposedValue":null},{"id":"157","baseId":null,"name":"Pacote Internet 300MB","price":"11.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"MOVEL ADICIONAIS","detail":null,"technology":null,"proposedValue":null},{"id":"158","baseId":null,"name":"Passaporte América","price":"9.99","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"MOVEL ADICIONAIS","detail":null,"technology":null,"proposedValue":null},{"id":"159","baseId":null,"name":"Pacote Internet 500MB","price":"18.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"MOVEL ADICIONAIS","detail":null,"technology":null,"proposedValue":null},{"id":"160","baseId":null,"name":"Passaporte Europa","price":"19.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"MOVEL ADICIONAIS","detail":null,"technology":null,"proposedValue":null},{"id":"161","baseId":null,"name":"Pacote Internet 1GB","price":"29.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"MOVEL ADICIONAIS","detail":null,"technology":null,"proposedValue":null},{"id":"162","baseId":null,"name":"Passaporte Mundo","price":"29.99","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"MOVEL ADICIONAIS","detail":null,"technology":null,"proposedValue":null},{"id":"163","baseId":null,"name":"Pacote Internet 2GB","price":"49.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"MOVEL ADICIONAIS","detail":null,"technology":null,"proposedValue":null},{"id":"164","baseId":null,"name":"Claro SYNC","price":"19.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"MOVEL ADICIONAIS","detail":null,"technology":null,"proposedValue":null},{"id":"165","baseId":null,"name":null,"price":"19.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"TV PONTOS ADICIONAIS","detail":null,"technology":"DIGITAL","proposedValue":null},{"id":"166","baseId":null,"name":null,"price":"29.90","offerType":"Padrão","promotion":{"id":null,"name":null,"description":null,"discount":{"value":null,"validFor":null}},"type":"TV PONTOS ADICIONAIS","detail":null,"technology":"HD","proposedValue":null}]}]}}';

		NBA_IntegrationUtils.HttpResponseModel httpResponseModel = new NBA_IntegrationUtils.HttpResponseModel();
		httpResponseModel.success = false;
		httpResponseModel.statusCode = 200;
		httpResponseModel.status = 'SUCCESS';
		httpResponseModel.body = 'TEST';
		httpResponseModel.bodyObject = null;
		
		Map<String, Object> request = new Map<String, Object> ();
					request.put('operatorId', '13');
					request.put('contractNumber', '70280795');
					request.put('documentNumber', '000');
					request.put('attendantProfile', 'T2880167');
					request.put('eventType', 'CRN - Retenção');
					request.put('reason', 'OUTROS');
					request.put('subreason', 'PR1 PR2');
					request.put('offerId', 'SP');
					request.put('caseId', '123093');
					request.put('serviceProvider', 'URA');
					request.put('channel', 'Salesforce');
					request.put('quantity', '5');  

		String nomeConfiguracao = 'NBA_List_Offers';
		NBA_Integration_Definitions__mdt configuracao = NBA_IntegrationUtils.getConfiguracaoDeIntegracao(nomeConfiguracao);

		Test.setMock(HttpCalloutMock.class, new NBA_IntegrationServicesMock_Test(MOCK,SET_HEADER_KEY,SET_HEADER_VALUE,STATUS_CODE_SUCCS));

		Test.startTest();

		NBA_IntegrationUtils.HttpResponseModel retornoHttpResponseModel1 = NBA_IntegrationUtils.sendRequest(configuracao, request);
		System.assertNotEquals(null, retornoHttpResponseModel1 );

		NBA_IntegrationUtils.HttpResponseModel retornoHttpResponseModel2 = NBA_IntegrationUtils.sendRequest(configuracao, request);
		System.assertNotEquals(null, retornoHttpResponseModel2 );
		
		Test.stopTest();
	}
    
    @IsTest
	public static void sendMockRequest(){
        Test.startTest();
         NBA_IntegrationUtils.searchMock('Mock');
        NBA_IntegrationUtils.searchMockOfertas('Mock_Ofertas');
        Test.stopTest();
    }
}